import { TranspilerEngine } from '../compiler/transpiler/engine';
import { Artifact } from '../artifacts/schemas/sovereignArtifact';

async function testIntegration() {
    console.log("üß™ RUNNING SOVEREIGN INTEGRATION TEST...");

    const mockArtifact: Artifact = {
        uid: "SOV-999",
        name: "core_logic.ts",
        type: 'CODE',
        version: '1.0.0',
        content: "console.log('Sovereign Executing...');",
        checksum: "abc",
        createdAt: Date.now()
    };

    try {
        const source = TranspilerEngine.transpileToSource(mockArtifact);
        console.log("‚úÖ [PASS] Transpilation & Security Check");
        if (!source.includes("GENERATED BY FEAC")) throw new Error("Missing Header");
        console.log("‚úÖ [PASS] Industrial Header Injection");
    } catch (e) {
        console.error("‚ùå [FAIL] Integration Test:", e);
        process.exit(1);
    }

    console.log("‚ú® ALL INTEGRATION TESTS PASSED.");
}

testIntegration();
